<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>CV Preview</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Inline minimal Tailwind CDN for server-side preview -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');
  </style>
</head>
<body class="bg-gray-50 p-8">
  <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-10">
    
    <!-- HEADER -->
    <header class="text-center border-b-2 border-blue-600 pb-4 mb-6">
      <h1 class="text-4xl font-bold text-gray-800 mb-3">{{ cv.personal_info.name or "" }}</h1>
      <div class="flex flex-wrap justify-center items-center gap-3 text-sm text-gray-600">
        {% if cv.personal_info.github %}
        <a href="{{ cv.personal_info.github }}" target="_blank" class="hover:text-blue-600">
          <i class="fab fa-github"></i> {{ cv.personal_info.github.split('/')[-1] }}
        </a>
        <span>|</span>
        {% endif %}
        {% if cv.personal_info.linkedin %}
        <a href="{{ cv.personal_info.linkedin }}" target="_blank" class="hover:text-blue-600">
          <i class="fab fa-linkedin"></i> {{ cv.personal_info.linkedin.split('/')[-1] }}
        </a>
        <span>|</span>
        {% endif %}
        {% if cv.personal_info.email %}
        <a href="mailto:{{ cv.personal_info.email }}" class="hover:text-blue-600">
          <i class="fas fa-envelope"></i> {{ cv.personal_info.email }}
        </a>
        <span>|</span>
        {% endif %}
        {% if cv.personal_info.phone %}
        <span>
          <i class="fas fa-mobile-alt"></i> {{ cv.personal_info.phone }}
        </span>
        {% endif %}
      </div>
      {% if cv.personal_info.portfolio %}
      <div class="mt-2">
        <a href="{{ cv.personal_info.portfolio }}" target="_blank" class="text-sm text-blue-600 hover:underline">
          <i class="fas fa-globe"></i> Portfolio
        </a>
      </div>
      {% endif %}
    </header>

    <!-- SUMMARY -->
    {% if cv.summary %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-3">Summary</h2>
      <p class="text-gray-700 leading-relaxed whitespace-pre-line">{{ cv.summary }}</p>
    </section>
    {% endif %}

    <!-- CURRENT ROLE AND RESPONSIBILITIES -->
    {% if cv.experience %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Current Role and Responsibilities</h2>
      {% for ex in cv.experience[:1] %}
      <div class="mb-4">
        <div class="flex justify-between items-start mb-2">
          <div>
            <h3 class="text-lg font-bold text-gray-800">{{ ex.role or "Role" }}</h3>
            <p class="text-gray-600 font-medium">{{ ex.company or "Company" }}</p>
          </div>
          <div class="text-right text-gray-600">
            <p class="font-medium">{{ ex.start_date or "" }} - {{ ex.end_date or "Present" }}</p>
          </div>
        </div>
        {% if ex.description %}
        <div class="mt-2">
          {% if ex.description is string and ('\n' in ex.description or '•' in ex.description or '-' in ex.description[:10]) %}
            {% set desc_lines = ex.description.split('\n') %}
            <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
              {% for line in desc_lines %}
                {% if line.strip() %}
                  {% set cleaned = line.strip().lstrip('•-*').strip() %}
                  <li>{{ cleaned }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-gray-700 whitespace-pre-line">{{ ex.description }}</p>
          {% endif %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </section>
    {% endif %}

    <!-- CAREER PROGRESSION -->
    {% if cv.experience|length > 1 %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Career Progression</h2>
      {% for ex in cv.experience[1:] %}
      <div class="mb-4">
        <div class="flex justify-between items-start mb-2">
          <div>
            <h3 class="text-lg font-bold text-gray-800">{{ ex.role or "Role" }}</h3>
            <p class="text-gray-600 font-medium">{{ ex.company or "Company" }}</p>
          </div>
          <div class="text-right text-gray-600">
            <p class="font-medium">{{ ex.start_date or "" }} - {{ ex.end_date or "Present" }}</p>
          </div>
        </div>
        {% if ex.description %}
        <div class="mt-2">
          {% if ex.description is string and ('\n' in ex.description or '•' in ex.description or '-' in ex.description[:10]) %}
            {% set desc_lines = ex.description.split('\n') %}
            <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
              {% for line in desc_lines %}
                {% if line.strip() %}
                  {% set cleaned = line.strip().lstrip('•-*').strip() %}
                  <li>{{ cleaned }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-gray-700 whitespace-pre-line">{{ ex.description }}</p>
          {% endif %}
        </div>
        {% endif %}
      </div>
      {% if not loop.last %}
      <div class="my-3"></div>
      {% endif %}
      {% endfor %}
    </section>
    {% endif %}

    <!-- PROJECTS -->
    {% if cv.projects %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Projects</h2>
      {% for p in cv.projects %}
      <div class="mb-4">
        <div class="flex justify-between items-start mb-2">
          <h3 class="text-lg font-bold text-gray-800">{{ p.project_name or p.title or "Project" }}</h3>
          {% if p.date %}
          <span class="text-gray-600">{{ p.date }}</span>
          {% endif %}
        </div>
        {% if p.description %}
        <div class="mt-2">
          {% if p.description is string and ('\n' in p.description or '•' in p.description or '-' in p.description[:10]) %}
            {% set desc_lines = p.description.split('\n') %}
            <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
              {% for line in desc_lines %}
                {% if line.strip() %}
                  {% set cleaned = line.strip().lstrip('•-*').strip() %}
                  <li>{{ cleaned }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-gray-700">{{ p.description }}</p>
          {% endif %}
        </div>
        {% endif %}
        {% if p.technologies %}
        <p class="text-sm text-gray-600 mt-2">
          <strong>Technologies:</strong> {{ p.technologies if p.technologies is string else p.technologies|join(', ') }}
        </p>
        {% endif %}
      </div>
      {% if not loop.last %}
      <div class="my-2"></div>
      {% endif %}
      {% endfor %}
    </section>
    {% endif %}

    <!-- EDUCATION -->
    {% if cv.education %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Education</h2>
      {% for ed in cv.education %}
      <div class="mb-3">
        <div class="flex justify-between items-start">
          <div>
            <p class="font-bold text-gray-800">{{ ed.degree or ed.description or "Degree" }}</p>
            <p class="text-gray-600">{{ ed.institute or ed.college or "Institution" }}</p>
          </div>
          <div class="text-right">
            <p class="text-gray-600">{{ ed.start_year or "" }} - {{ ed.end_year or "" }}</p>
            {% if ed.gpa or ed.score %}
            <p class="text-sm text-gray-600 italic">GPA: {{ ed.gpa or ed.score }}</p>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </section>
    {% endif %}

    <!-- SKILLS -->
    {% if cv.skills %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Skills</h2>
      {% if cv.skills is string %}
        <p class="text-gray-700">{{ cv.skills }}</p>
      {% elif cv.skills is mapping %}
        {% for category, skills_list in cv.skills.items() %}
        <div class="mb-2">
          <strong class="text-gray-800">{{ category }}:</strong>
          <span class="text-gray-700">{{ skills_list if skills_list is string else skills_list|join(', ') }}</span>
        </div>
        {% endfor %}
      {% else %}
        {% set skills_str = cv.skills|join(', ') if cv.skills is iterable and cv.skills is not string else cv.skills %}
        <p class="text-gray-700">{{ skills_str }}</p>
      {% endif %}
    </section>
    {% endif %}

    <!-- CERTIFICATIONS -->
    {% if cv.certifications %}
    <section class="mb-6">
      <h2 class="text-2xl font-bold text-blue-600 uppercase tracking-wide border-b-2 border-blue-600 pb-2 mb-4">Certifications</h2>
      {% for cert in cv.certifications %}
      <div class="mb-2">
        <p class="text-gray-700">
          <strong>{{ cert.name or cert.title or "Certification" }}</strong>
          {% if cert.issuer or cert.organization %}
            - {{ cert.issuer or cert.organization }}
          {% endif %}
          {% if cert.year %}
            ({{ cert.year }})
          {% endif %}
        </p>
      </div>
      {% endfor %}
    </section>
    {% endif %}

  </div>
</body>
</html>
